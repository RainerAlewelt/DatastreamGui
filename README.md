# DatastreamGui

A JavaFX GUI for receiving and visualizing IENA-format UDP data streams in real time, with Python sender/receiver scripts for testing and development.

Variable names and count are defined dynamically via **XidML metadata files** rather than hardcoded, allowing flexible stream configurations (e.g. `temperature, pressure, altitude` instead of fixed `a` through `z`).

## Features

- **Unicast and Multicast** UDP reception
- **Stream discovery** — scan for active IENA streams on the network
- **Dynamic variables** — parameter names loaded from XidML metadata files
- **Multiple display types** — numerical value, horizontal bar, and line plots
- **Draggable panels** — arrange displays freely on the workspace
- **Multi-variable plots** — overlay multiple variables on a single chart
- **Layout save/load** — persist and restore workspace arrangements as JSON
- **Color picker** — customizable colors per variable

## Prerequisites

- Java 25+ with JavaFX
- Maven
- Python 3.10+ (for sender/receiver scripts)
- `matplotlib` and `numpy` (for the Python receiver's live plot)

## Quick Start

### 1. Start the sender

Default (26 variables, a–z):
```bash
python3 iena_multicast_sender.py
```

Custom variables:
```bash
python3 iena_multicast_sender.py --vars temperature,pressure,altitude --config-out my_stream.xidml
```

The sender generates a `.xidml` metadata file on startup and begins multicasting IENA packets.

### 2. Launch the GUI

```bash
mvn compile javafx:run
```

### 3. Connect

1. Click **Connect...** in the sidebar
2. Go to the **Multicast** tab
3. Browse for the `.xidml` file generated by the sender
4. Click **Connect Without Scanning** (or scan first to discover streams)
5. The variable dropdown populates from the XidML — select a variable, choose a display type, and click **Add**

## IENA Packet Format

Big-endian UDP packets:

| Section | Size | Contents |
|---------|------|----------|
| Header | 16 bytes | key(2) + size(2) + time_high(4) + time_low(2) + status(2) + seq(2) + n2(2) |
| Payload | N × 4 bytes | N float32 values |
| Trailer | 2 bytes | `0xDEAD` |

The number of floats (N) is determined by the XidML file, not hardcoded.

## XidML Metadata Format

```xml
<?xml version="1.0" encoding="UTF-8"?>
<XidML version="3.0">
  <Instrumentation>
    <Package name="MyStream" ienaKey="0x0A01">
      <ParameterSet>
        <Parameter name="temperature" index="0">
          <DataFormat>Float32</DataFormat>
          <RangeMinimum>0.0</RangeMinimum>
          <RangeMaximum>100.0</RangeMaximum>
        </Parameter>
        <Parameter name="pressure" index="1">
          <DataFormat>Float32</DataFormat>
          <RangeMinimum>0.0</RangeMinimum>
          <RangeMaximum>1100.0</RangeMaximum>
        </Parameter>
      </ParameterSet>
    </Package>
  </Instrumentation>
</XidML>
```

## Sender Options

```
--group GROUP       Multicast group (default: 239.1.1.1)
--port PORT         UDP port (default: 5001)
--rate HZ           Packets per second (default: 10)
--key KEY           IENA stream key (default: 0x0A01)
--ttl TTL           Multicast TTL (default: 1)
--iface IFACE       Source interface IP
--vars NAMES        Comma-separated variable names (default: a through z)
--config-out PATH   XidML output path (default: stream_config.xidml)
```

## Receiver Options

```
--group GROUP       Multicast group(s) (default: 239.1.1.1)
--port PORT         UDP port (default: 5001)
--key KEY           Skip scan, receive this IENA key directly
--vars NAMES        Variables to plot (default: first 3 from config)
--window SECONDS    Scrolling plot window (default: 30)
--config PATH       XidML file for parameter names/count
```

## Project Structure

```
├── iena_multicast_sender.py      # Python IENA packet sender
├── iena_multicast_receiver.py    # Python receiver with live matplotlib plot
├── pom.xml                       # Maven build config
└── src/main/java/dyn/
    ├── MainApp.java              # JavaFX application entry point
    ├── ConnectionWindow.java     # Connect dialog (unicast/multicast + XidML)
    ├── DataStream.java           # IENA UDP receiver + XidML parser
    ├── PlotPanel.java            # Line plot display
    ├── BarPanel.java             # Horizontal bar display
    ├── NumericPanel.java         # Numeric value display
    ├── DraggablePanel.java       # Base class for movable/resizable panels
    └── LayoutManager.java        # Save/load workspace layouts as JSON
```
